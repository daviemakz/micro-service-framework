language: node_js
node_js:
  - '10'
  - '12'
  - 'lts/*'

script: echo "Running tests against $(node -v) ..."

jobs:
  include:
    - stage: initialise
      name: 'install submodules'
      script: ./ci/init-docs.sh
    - stage: test
      name: 'integration tests'
      script: ./ci/test.sh
    - stage: publish
      name: 'documentation'
      script: ./ci/deploy-docs.sh
    - script: ./ci/deploy-package.sh
      name: 'package'

stages:
  - initialise
  - test
  - name: publish
    if: branch = master
